"use strict";(globalThis["webpackChunkrecpro"]=globalThis["webpackChunkrecpro"]||[]).push([[64],{5151:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var src_stores_example_store__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9290),src_stores_keyboard__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(748),three__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6535),vue__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(499);const store=(0,src_stores_example_store__WEBPACK_IMPORTED_MODULE_0__.o)(),minX=0,maxX=122,minY=-18,maxY=60,activePlane=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)(1);let lastMainCoordinate={x:0,y:0};const activeMaterial=new three__WEBPACK_IMPORTED_MODULE_3__.xoR({color:16777215,specular:16777215,shininess:30}),cubeMaterial=new three__WEBPACK_IMPORTED_MODULE_3__.xoR({color:8410453,specular:8410453,shininess:30}),cubeMaterial2=new three__WEBPACK_IMPORTED_MODULE_3__.xoR({color:8421504,specular:8421504,shininess:30});let btnTouchTime=0;const touchButton=name=>{if((new Date).getTime()-btnTouchTime<1e3*store.btnBounce)return;store.playAudio=!0;const btn=name.replace("right","");if(console.log(name,btn),btnTouchTime=(new Date).getTime(),"C"==btn)store.content="";else if("="==btn){const exp=store.content.replaceAll("÷","/");try{store.content=eval(exp)}catch(error){store.content="表达式错误"}}else store.content=store.content+btn},keyboard=(0,src_stores_keyboard__WEBPACK_IMPORTED_MODULE_1__.U)(),getPositionBlock=(e,t)=>{const i=keyboard.keyboard.find((i=>{const{x:o,y:n}=i.leftBottom,{x:a,y:s}=i.rightTop;return e>=o&&e<=a&&t>=n&&t<=s}));if(i){const e=(i.leftBottom.x+i.rightTop.x)/2,t=(i.leftBottom.y+i.rightTop.y)/2,o=i.height;return{name:i.name,x:e,y:t,z:o}}return null},blockBallTimer=new Map,ballState=[],updateBall=()=>{if(0==activePlane.value){balls.forEach((e=>e.visible=!1));let e=balls[0];balls.forEach((t=>{t.position.y<e.position.y&&(e=t)})),e.visible=!0;const t=[];store.scene?.getObjectByName("blockGroup")?.children.filter((e=>e.name.startsWith("left"))).forEach((i=>{const o=i.position.x,n=i.position.y;if(e.position.x>o-6&&e.position.x<o+6&&e.position.y>n-6&&e.position.y<n+6){const o=e.position.z-store.buttonHeight.low;e.children[0].scale.set(1,o/100,1),o<2?(i.material=activeMaterial,touchButton(i.name),t.push(i.name)):i.material=cubeMaterial}else t.includes(i.name)||(i.material=cubeMaterial)}))}else 1==activePlane.value?(store.scene?.getObjectByName("blockGroup")?.children.forEach((e=>{e.material=cubeMaterial2})),balls.forEach((e=>{if(e.position.z<0||e.position.z>80||0==e.visible)return;const t=getPositionBlock(e.position.x,e.position.y);if(t){if(e.position.z>t.z)return void store.pushRealTimeCoordinate(`${t.name} 上小球因高度超出不触发`);if(void 0!=blockBallTimer.get(t.name)&&(new Date).getTime()-blockBallTimer.get(t.name)<200)return void store.pushRealTimeCoordinate(`${t.name} 上小球因 200ms 内有小球不触发`);if(blockBallTimer.set(t.name,(new Date).getTime()),0==ballState.length)return;if(ballState[0].find((t=>t.distanceTo(e.position)<store.L1)))return void store.pushRealTimeCoordinate(`${t.name} 上小球因上一次同步在L1范围内不触发`);if(ballState[0].find((t=>t.distanceTo(e.position)<store.L2))){const e=store.scene?.getObjectByName("blockGroup")?.getObjectByName(t.name);return e.material=activeMaterial,void touchButton(t.name)}store.pushRealTimeCoordinate(`${t.name} 上小球因上一次同步不在L2范围内不触发`)}})),ballState.unshift(balls.map((e=>e.position.clone()))),ballState.length>5&&ballState.pop()):balls.forEach((e=>{e.visible=!1}))},receiveMainCoordinate=(e,t,i,o)=>{},getHeight=(e,t)=>0===e&&0===t||0===e&&3===t||3===e&&0===t||3===e&&3===t?store.buttonHeight.high:e>0&&t>0&&e<3&&t<3?store.buttonHeight.low:store.buttonHeight.medium,getAxisHeight=(e,t)=>getPositionBlock(e,t)?.z??1,receiveSubBallCoordinate=(e,t,i,o,n)=>{o<=n&&updateBall();const a=balls[o];if(e>2e3&&t>2e3)return void(a.visible=!1);const s=parseInt(String(store.getAxisRate.x))*e+parseInt(String(store.getAxisOffset.x)),r=parseInt(String(store.getAxisRate.y))*t+parseInt(String(store.getAxisOffset.y)),l=parseInt(String(store.getAxisRate.z))*i+parseInt(String(store.getAxisOffset.z)),_=(parseInt(String(s))-store.minX)/(store.maxX-store.minX)*(maxX-minX)+minX,c=(parseInt(String(r))-store.minY)/(store.maxY-store.minY)*(maxY-minY)+minY;let h=_,m=c,u=l;(h<0||h>122)&&(h=h<0?0:122),(m<minY||m>maxY)&&(m=m<minY?minY:maxY),a.position.set(h,m,u),a.visible=!0;const d=u-getAxisHeight(h,m);a.children[0].scale.set(1,d/100,1),store.pushRealTimeCoordinate(`${o}号小球 ${parseInt(String(e))},${parseInt(String(t))},${parseInt(String(i))} 映射后 ${parseInt(String(h))},${parseInt(String(m))},${parseInt(String(u))} 偏移${parseInt(String(store.getAxisOffset.x))} 调整前${parseInt(String(e))}后${s}`)};let balls=[];const createBall=e=>{balls=[];new three__WEBPACK_IMPORTED_MODULE_3__.xoR({color:"red",shininess:30});const t=new three__WEBPACK_IMPORTED_MODULE_3__.vBJ({color:"red"}),i=new three__WEBPACK_IMPORTED_MODULE_3__.xo$(2,32,32);for(let o=0;o<4;o++){const o=new three__WEBPACK_IMPORTED_MODULE_3__.Kj0(i,t);o.position.set(0,0,100),o.visible=!1;const n=new three__WEBPACK_IMPORTED_MODULE_3__.fHI(.2,.2,100,16),a=new three__WEBPACK_IMPORTED_MODULE_3__.Kj0(n,t);a.position.set(0,0,0),a.geometry.translate(0,-50,0),a.rotateOnAxis(new three__WEBPACK_IMPORTED_MODULE_3__.Pa4(1,0,0),Math.PI/2),o.add(a);const s=new three__WEBPACK_IMPORTED_MODULE_3__.xo$(1,16,16),r=new three__WEBPACK_IMPORTED_MODULE_3__.Kj0(s,t);a.add(r),r.position.set(0,0,0),r.geometry.translate(0,-100,0),a.scale.set(1,.3,1),e.add(o),balls.push(o)}},initReceiveFunction=()=>{window.receiveMainCoordinate=receiveMainCoordinate,store.subBallReceiver.set("ball",receiveSubBallCoordinate)},removeReceiveFunction=()=>{store.subBallReceiver.delete("ball")},__WEBPACK_DEFAULT_EXPORT__={createBall,updateBall,initReceiveFunction,removeReceiveFunction}},794:(e,t,i)=>{i.d(t,{Z:()=>c});var o=i(6535);const n=new o.xoR({color:2293759,shininess:55}),a=new o.xoR({color:65535,shininess:30});let s=[null,null];const r=(e,t=122,i=62)=>{const a=new o._12(t,i,50),r=new o.Kj0(a,n);r.position.set(-41,0,0),s[0]=r;const l=new o.Kj0(a,n);l.position.set(t/2,i/2,0),e.add(l),s[1]=l},l=e=>{s[e]&&(s[e].material=a)},_=e=>{s[e]&&(s[e].material=n)},c={createPlane:r,activePlane:l,deactivePlane:_}},9290:(e,t,i)=>{i.d(t,{o:()=>n});var o=i(3746);const n=(0,o.Q_)("recPro",{state:()=>({buttonHeight:{high:20,medium:16,low:12},axisRate:{x:1,y:1,z:1},axisOffset:{x:1,y:1,z:1},axisRate2:{x:1,y:1,z:1},axisOffset2:{x:1,y:1,z:1},realTimeCoordinate:[],maxCoordinate:10,updateCoordinate:!0,scene:null,minX:0,maxX:1e3,minY:0,maxY:1e3,threshold:5,btnBounce:4.5,content:"",playAudio:!1,L1:3,L2:8,enableScene:0,subBallReceiver:new Map}),getters:{getAxisRate:e=>e.axisRate,getAxisOffset:e=>e.axisOffset,getButtonHeight:e=>e.buttonHeight,heightKey:e=>e.buttonHeight.high+"_"+e.buttonHeight.medium+"_"+e.buttonHeight.low,totalKey:e=>e.axisRate.x+"_"+e.axisRate.y+"_"+e.axisRate.z+"_"+e.axisOffset.x+"_"+e.axisOffset.y+"_"+e.axisOffset.z+"_"+e.axisRate2.x+"_"+e.axisRate2.y+"_"+e.axisRate2.z+"_"+e.axisOffset2.x+"_"+e.axisOffset2.y+"_"+e.axisOffset2.z+"_"+e.buttonHeight.high+"_"+e.buttonHeight.medium+"_"+e.buttonHeight.low+"_"+e.minX+"_"+e.maxX+"_"+e.minY+"_"+e.maxY+"_"+e.threshold+"_"+e.btnBounce+"_"+e.L1+"_"+e.L2},actions:{pushRealTimeCoordinate(e){this.updateCoordinate&&(this.realTimeCoordinate.unshift(e),this.realTimeCoordinate.length>=this.maxCoordinate&&this.realTimeCoordinate.pop())}}})},748:(e,t,i)=>{i.d(t,{U:()=>_});var o=i(9290),n=i(3746);const a=(0,o.o)(),s=["123*+ ","4560=C","789÷- "].map((e=>e.split(""))),r=[[[18,20],[18,13],[18,18],[18,18],[18,18],[0,0]],[[13,14],[18,18],[18,18],[18,18],[18,18],[18,18]],[[18,20],[18,13],[18,18],[18,18],[18,18],[0,0]]],l=()=>{let e=[];for(let t=0;t<3;t++){let i=2,o=60-18*t;for(let n=0;n<6;n++){if(" "==s[t][n])continue;i+=r[0][n][0]/2,0==t?o=60-r[0][n][1]/2:1==t?(o=31,0==n&&(i=8.5),5==n&&(i=2+r[0][n][0]/2+108+2)):2==t&&(o=2+r[0][n][1]/2);let l=a.buttonHeight.high;1==t&&n>0&&n<5&&(l=a.buttonHeight.low);const _=r[t][n][0]/2,c=r[t][n][1]/2,h=s[t][n];e.push({xIndex:n,yIndex:t,name:h,height:l,leftBottom:{x:i-_,y:o-c},rightTop:{x:i+_,y:o+c}}),0==n&&1==t&&(i+=2),i+=20-r[0][n][0]/2}}return e},_=(0,n.Q_)("keyboard",{state:()=>({keyboard:[]}),getters:{keyboardMapper:e=>{let t=new Map;return e.keyboard.forEach((e=>{t.set(e.xIndex+","+e.yIndex,e)})),t},keyboardKey:e=>e.keyboard.map((e=>e.name+"_"+e.height+"_"+e.leftBottom.x+"_"+e.leftBottom.y+"_"+e.rightTop.x+"_"+e.rightTop.y)).join("+")},actions:{pushDefault(){this.keyboard=l()}}})},6309:(e,t,i)=>{i.d(t,{Z:()=>d});var o=i(9835),n=i(9302),a=i(9290),s=i(748),r=i(6535),l=i(2878),_=i(499),c=i(5151),h=i(794);const m=(0,o.aZ)({__name:"Scene",setup(e){const t=(0,_.iH)();(0,n.Z)();let i,m,u,d=!1;var p=new r.SUY,g=24,x=1/g,b=0;const f=()=>{if(!d){requestAnimationFrame(f);var e=p.getDelta();b+=e,b>x&&(u.render(i,m),b=0)}},E=(0,a.o)();(0,o.YP)((()=>E.heightKey),(e=>{i.clear(),y()}));const w=(0,s.U)();(0,o.YP)((()=>w.keyboardKey),(e=>{i.clear(),y()}));const T=()=>{const e=new r.xoR({color:8421504,specular:8421504,shininess:30}),t=new r.ZAu;t.name="blockGroup",i.add(t);const o=document.createElement("canvas");o.width=128,o.height=128;const n=o.getContext("2d");n.font="48px Arial",n.fillStyle="rgba(255,255,255,1)",n.textAlign="center",n.textBaseline="middle",w.keyboard.forEach((i=>{const a=i.height,s=i.leftBottom,l=i.rightTop,_=i.name,c=(s.x+l.x)/2,h=(s.y+l.y)/2,m=l.x-s.x,u=l.y-s.y,d=new r.DvJ(m,u,a),p=new r.Kj0(d,e);p.position.set(c,h,a/2),p.name=_,n.clearRect(0,0,128,128),n.fillText(_,48,48);const g=(new r.dpR).load(o.toDataURL("image/png")),x=new r.vBJ({map:g,transparent:!0}),b=new r._12(24,24),f=new r.Kj0(b,x);f.position.set(3,-3,1+a/2),p.add(f),t.add(p)}))},v=()=>{const e=document.createElement("canvas");e.width=286,e.height=128;const t=e.getContext("2d");t.font="48px 'STKaiti', '华文楷体', serif",t.fillStyle="rgba(255,0,0, 0.8)",t.textAlign="center",t.textBaseline="middle",t.fillText("原",32,64),t.fillText("宇",96,64),t.fillText("科",160,64),t.fillText("技",224,64);const o=(new r.dpR).load(e.toDataURL("image/png")),n=new r.vBJ({map:o,transparent:!0,side:r.ehD}),a=new r._12(124,50),s=new r.Kj0(a,n);s.position.set(61,69,30),s.rotation.x=Math.PI/2,i.add(s),e.remove()},y=()=>{i.add(m),h.Z.createPlane(i),c.Z.createBall(i);const e=new r.Ox3(16777215,1);e.position.set(20,20,10),i.add(e),m.position.x=61,T(),v()};let B=!1,R={width:0,height:0};const O=()=>{const e=t.value;i=new r.xsS,E.scene=i;const o=document.querySelector(".scene");B||(R.width=o.clientWidth,R.height=o.clientHeight),m=new r.cPb(80,R.width/R.height,.1,3e3),m.position.set(61,-31,90),m.lookAt(61,31,0),u=new r.CP7,u.setSize(R.width,R.height-40),u.setClearColor(12178431,1),e.appendChild(u.domElement);const n=new l.z(m,u.domElement);n.enableDamping=!0,n.target.set(61,31,0),n.update(),B=!0,y(),f()};return(0,o.bv)((()=>{O(),setTimeout((()=>{const e=E.buttonHeight.low;E.buttonHeight.low=10,setTimeout((()=>{E.buttonHeight.low=e}),500)}),5e3),setTimeout((()=>{c.Z.initReceiveFunction()}),500)})),(0,o.Jd)((()=>{d=!0,c.Z.removeReceiveFunction()})),(e,i)=>((0,o.wg)(),(0,o.iD)("div",{ref_key:"video_container",ref:t,class:"full-width full-height scene absolute"},null,512))}}),u=m,d=u}}]);